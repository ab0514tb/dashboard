<!DOCTYPE html>
<html>
<head lang='en'>
    <meta charset='UTF-8'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.min.css"/>
    <link rel="stylesheet" href="https://cdn.datatables.net/t/bs-3.3.6/jqc-1.12.0,dt-1.10.11/datatables.min.css"/>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/t/bs-3.3.6/jqc-1.12.0,dt-1.10.11/datatables.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nvd3/1.8.6/nv.d3.js"></script>
    <script>
$(function(){

$('#test').on('click',function(){
     console.log('hogehoge');
    // #svg: ターゲットの svg 要素
    var width = $("#svg").width();
    var height = $("#svg").height();
    $("body").append("<canvas id='canvas1' class='hidden' width="
                                      + width + " height=" + height +"></canvas>");

    var canvas = $("#canvas1")[0];
    var ctx = canvas.getContext("2d");

    var svg = $("#svg");
    svg.attr("viewBox", "0 0 " + width + " " + height);

    var data = new XMLSerializer().serializeToString(svg[0]);
    var imgsrc = "data:image/svg+xml;charset=utf-8;base64,"
                           + btoa(unescape(encodeURIComponent(data)));
    var image = new Image();
    image.onload = function(){

        ctx.drawImage(image, 0, 0);
        // Optional: 自動でダウンロードさせる場合
        $("body").append("<a id='image-file' class='hidden' type='application/octet-stream' href='"
                           + canvas.toDataURL("image/png") + "' download='graph.png'>Donload Image</a>");
        $("#image-file")[0].click();

        // 後処理
        $("#canvas1").remove();
        $("#image-file").remove();

    }
    image.src = imgsrc;
});

        /*These lines are all chart setup.  Pick and choose which chart features you want to utilize. */
nv.addGraph(function() {
  var chart = nv.models.lineChart()
                .useInteractiveGuideline(true)  //We want nice looking tooltips and a guideline!
                .showLegend(true)       //Show the legend, allowing users to turn on/off line series.
                .showYAxis(true)        //Show the y-axis
                .showXAxis(true)        //Show the x-axis
  ;

  chart.xAxis     //Chart x-axis settings
      .axisLabel('Time (ms)')
      .tickFormat(d3.format(',r'));

  chart.yAxis     //Chart y-axis settings
      .axisLabel('Voltage (v)')
      .tickFormat(d3.format('.02f'));

  /* Done setting the chart up? Time to render it!*/
  var myData = sinAndCos();   //You need data...

  d3.select('#chart svg')    //Select the <svg> element you want to render the chart in.
      .datum(myData)         //Populate the <svg> element with chart data...
      .call(chart);          //Finally, render the chart!

  //Update the chart when window resizes.
  nv.utils.windowResize(function() { chart.update() });
  return chart;
});
/**************************************
 * Simple test data generator
 */
function sinAndCos() {
  var sin = [],sin2 = [],
      cos = [];

  //Data is represented as an array of {x,y} pairs.
  for (var i = 0; i < 100; i++) {
    sin.push({x: i, y: Math.sin(i/10)});
    sin2.push({x: i, y: Math.sin(i/10) *0.25 + 0.5});
    cos.push({x: i, y: .5 * Math.cos(i/10)});
  }

  //Line chart data should be sent as an array of series objects.
  return [
    {
      values: sin,      //values - represents the array of {x,y} data points
      key: 'Sine Wave', //key  - the name of the series.
      color: '#ff7f0e'  //color - optional: choose your own line color.
    },
    {
      values: cos,
      key: 'Cosine Wave',
      color: '#2ca02c'
    },
    {
      values: sin2,
      key: 'Another sine wave',
      color: '#7777ff',
      area: true      //area - set to true if you want this line to turn into a filled area chart.
    }
  ];
};

});
    </script>
    <title>two-column</title>
    <style>
        html,
        body{
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
        }
        .main{
            display: flex;
            height: 100%;
        }
        .side{
            background: #69c;
            width: 120px;
        }
        .contents {
            flex: 1;
        }
        #chart {
            height: 100%;
        }
    </style>
</head>
<body>
<div class='main'>
    <div class='side'>
    </div>
    <a href='#' id='test'>testtesttest</a>
    <div class='contents'>
        <div id='chart'>
            <svg id='svg'></svg>
        </div>
    </div>
</div>
</body>
</html>
